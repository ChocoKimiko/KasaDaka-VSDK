{% extends "base.xml" %}
{% block content%}
<!--<form id="greeting">-->
  <!--<block>-->
     <!--&lt;!&ndash;say greeting&ndash;&gt;-->
     <!--<prompt>-->
        <!--<audio src="wavs/Hello_8KHz.wav"> &lt;!&ndash;Audio file: 'Hello!'&ndash;&gt;-->
           <!--<break time="1000"/>-->
        <!--</audio>-->
        <!--<voice xml:lang="fr">Bonjour!</voice>-->
     <!--</prompt>-->
     <!--<goto next="#language selection"/>-->
  <!--</block>-->
<!--</form>-->

<!--&lt;!&ndash;language selection&ndash;&gt;-->
<!--<menu id="language selection" dtmf="true">-->
  <!--<prompt>-->
     <!--<audio src="wavs/Select_English_8KHz.wav"> &lt;!&ndash;Audio file: 'For English, please press 1.'&ndash;&gt;-->
        <!--<break time="1000"/>-->
     <!--</audio>-->
     <!--<voice xml:lang="fr">Pour le fran√ßais, veuillez appuyer sur 2.</voice>-->
  <!--</prompt>-->
  <!--<choice dtmf="1" next="http://webhosting.voxeo.net/205779/www/english.vxml">English</choice>-->
  <!--<choice dtmf="2" next="http://webhosting.voxeo.net/205779/www/french.vxml ">French</choice>-->
<!--</menu>-->


<form id="language_form">
	<field name="select_language">
		<prompt>
            <!--Greeting-->
			{% for language in languages %}
                <audio src="{{ language.get_interface_voice_label_url_dict.voice_label }}"/>
			{% endfor %}

            <!--Language Selection-->
            {% for language in languages %}
			    <audio src="{{ language.get_interface_voice_label_url_dict.select_language }}"/>
			    {% for number in language.get_interface_numbers_voice_label_url_list %}{% if forloop.counter0 == forloop.parentloop.counter %}<audio src="{{ number }}"/>{% endif %}{% endfor %}
			{% endfor %}
		</prompt>



        <grammar xml:lang="en-US" root = "MYRULE" mode="dtmf">
            <rule id="MYRULE" scope = "public">
                <one-of>
                    {% for language in languages %}
                        <item>{{ forloop.counter }}</item>
                    {% endfor %}
                </one-of>
            </rule>
        </grammar>
        {# when there has been input, save the corresponding URI in the given variable #}
        <filled>
            {% for language in languages %}
                {% if forloop.counter == 1 %}
                    <if cond="language_field == '{{ forloop.counter }}'">
		            <assign name="language_id" expr="'{{ language.id }}'"/>
                {% else %}
                    <elseif cond="language_field == '{{ forloop.counter }}'" />
                    <assign name="language_id" expr="'{{ language.id }}'"/>
                {% endif %}
            {% endfor %}


            <else/>
            </if>

            <goto next="#submit_form"/>
        </filled>
    </field>
</form>


<form id="submit_form">
<block>
	{# include the variables in the dictionary 'pass_on_variables' as POST variables #}
	{% for key, value in pass_on_variables.items %}
	<assign name="{{ key }}" expr="'{{ value }}'"/>
	{% endfor %}
	<submit next="{{ redirect_url }}" method="post" namelist="language_id {% for key, value in pass_on_variables.items %} {{ key }} {% endfor %}"/>
</block>
</form>

{% endblock %}
